"use strict";(self.webpackChunkbackend=self.webpackChunkbackend||[]).push([[1926],{54729:(K,g,e)=>{e.d(g,{g:()=>y});var t=e(21272),u=e(90602),L=e(54894),M=e(74930);const y=(p={},O={})=>{const{id:m="",...f}=p,{get:d}=(0,u.ry)(),{locale:C}=(0,L.A)(),h=(0,u.QM)(C,{sensitivity:"base"}),{data:n,error:E,isError:o,isLoading:A,refetch:I}=(0,M.useQuery)(["roles",m,f],async()=>{const{data:i}=await d(`/admin/roles/${m??""}`,{params:f});return i},O);return{roles:t.useMemo(()=>{let i=[];return n&&(Array.isArray(n.data)?i=n.data:i=[n.data]),[...i].sort((v,P)=>h.compare(v.name,P.name))},[n,h]),error:E,isError:o,isLoading:A,refetch:I}}},67061:(K,g,e)=>{e.r(g),e.d(g,{SingleSignOn:()=>W,default:()=>F});var t=e(21272),u=e(53432),L=e(55794),M=e(43121),y=e(69564),p=e(32559),O=e(43242),m=e(57842),f=e(57564),d=e(68065),C=e(44158),h=e(45024),n=e(89787),E=e(5391),o=e(90602),A=e(13333),I=e(56336),b=e.n(I),i=e(54894),v=e(82437),P=e(67161),U=e(54729),B=e(71526),c=e(12083);const G=c.Ik().shape({autoRegister:c.lc().required(o.iW.required),defaultRole:c.gl().when("autoRegister",(a,l)=>a?l.required(o.iW.required):l.nullable()),ssoLockedRoles:c.YO().nullable().of(c.gl().when("ssoLockedRoles",(a,l)=>a?l.required(o.iW.required):l.nullable()))}),W=()=>{(0,o.L4)();const{formatMessage:a}=(0,i.A)(),l=(0,v.d4)(B.G),{isLoading:Q,allowedActions:{canUpdate:D,canReadRoles:k}}=(0,o.ec)({...l.settings.sso,readRoles:l.settings.roles.read}),[{formErrors:r,initialData:z,isLoading:H,modifiedData:R,showHeaderButtonLoader:$},,{handleChange:S,handleSubmit:Y}]=(0,P.T)("/admin/providers/options",G,()=>{},["autoRegister","defaultRole","ssoLockedRoles"]),{roles:x,isLoading:j}=(0,U.g)(void 0,{enabled:k}),J=Q||j||H;return t.createElement(u.P,null,t.createElement(o.x7,{name:"SSO"}),t.createElement(L.g,{tabIndex:-1},t.createElement("form",{onSubmit:Y},t.createElement(M.Q,{primaryAction:t.createElement(y.$,{"data-testid":"save-button",disabled:b()(z,R),loading:$,startIcon:t.createElement(A.A,null),type:"submit",size:"L"},a({id:"global.save",defaultMessage:"Save"})),title:a({id:"Settings.sso.title",defaultMessage:"Single Sign-On"}),subtitle:a({id:"Settings.sso.description",defaultMessage:"Configure the settings for the Single Sign-On feature."})}),t.createElement(p.s,null,J?t.createElement(o.Bl,null):t.createElement(O.s,{direction:"column",alignItems:"stretch",gap:4,background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0},t.createElement(m.o,{variant:"delta",as:"h2"},a({id:"global.settings",defaultMessage:"Settings"})),t.createElement(f.x,{gap:4},t.createElement(d.E,{col:6,m:6,s:12},t.createElement(C.l,{"aria-label":"autoRegister","data-testid":"autoRegister",disabled:!D,checked:R.autoRegister,hint:a({id:"Settings.sso.form.registration.description",defaultMessage:"Create new user on SSO login if no account exists"}),label:a({id:"Settings.sso.form.registration.label",defaultMessage:"Auto-registration"}),name:"autoRegister",offLabel:a({id:"app.components.ToggleCheckbox.off-label",defaultMessage:"Off"}),onLabel:a({id:"app.components.ToggleCheckbox.on-label",defaultMessage:"On"}),onChange:s=>{S({target:{name:"autoRegister",value:s.target.checked}})}})),t.createElement(d.E,{col:6,m:6,s:12},t.createElement(h.l,{disabled:!D,hint:a({id:"Settings.sso.form.defaultRole.description",defaultMessage:"It will attach the new authenticated user to the selected role"}),error:r.defaultRole?a({id:r.defaultRole.id,defaultMessage:r.defaultRole.id}):"",label:a({id:"Settings.sso.form.defaultRole.label",defaultMessage:"Default role"}),name:"defaultRole",onChange:s=>{S({target:{name:"defaultRole",value:s}})},placeholder:a({id:"components.InputSelect.option.placeholder",defaultMessage:"Choose here"}),value:R.defaultRole},x.map(({id:s,name:T})=>t.createElement(n.c,{key:s,value:s.toString()},T)))),t.createElement(d.E,{col:6,m:6,s:12},t.createElement(E.KF,{disabled:!D,hint:a({id:"Settings.sso.form.localAuthenticationLock.description",defaultMessage:"Select the roles for which you want to disable the local authentication"}),error:r.ssoLockedRoles?a({id:r.ssoLockedRoles.id,defaultMessage:r.ssoLockedRoles.id}):"",label:a({id:"Settings.sso.form.localAuthenticationLock.label",defaultMessage:"Local authentication lock-out"}),name:"ssoLockedRoles",onChange:s=>{S({target:{name:"ssoLockedRoles",value:s}})},placeholder:a({id:"components.InputSelect.option.placeholder",defaultMessage:"Choose here"}),onClear:()=>{S({target:{name:"ssoLockedRoles",emptyArray:[]}})},value:R.ssoLockedRoles||[],withTags:!0},x.map(({id:s,name:T})=>t.createElement(E.fe,{key:s,value:s.toString()},T))))))))))},F=()=>{const a=(0,v.d4)(B.G);return t.createElement(o.kz,{permissions:a.settings.sso.main},t.createElement(W,null))}}}]);
